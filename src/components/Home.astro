---
// Componente Hero.astro
---

<main class="bg-oscuro text-white w-full">
  <!-- Hero Section with Typing Effect -->
  <section id="Inicio" class="pt-20 md:pt-24 lg:pt-28 pb-8 md:pb-12 px-4 sm:px-6 lg:px-8">
    <div class="container mx-auto max-w-6xl">
      <div class="max-w-4xl">
        <h1 class="text-2xl md:text-5xl lg:text-6xl font-bold mb-4 md:mb-6 leading-tight">
          Te hacemos 
          <span class="text-lila">
            &lt; <span class="typing-container"><span id="typewriter" class="typing-text"></span></span>
            <span class="typing-cursor text-lila">|</span> /&gt;
          </span>
        </h1>

        <p class="text-lg md:text-xl text-gray-300 mb-8 max-w-2xl leading-relaxed">
          Somos tu equipo tech. Transformamos ideas en productos digitales
          a medida. Desarrollo de software, diseño UX/UI y mantenimiento.
        </p>

        <a href="#contacto" class="inline-block bg-violet-600 hover:bg-violet-700 text-white font-medium px-6 py-3 rounded transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-black">
          Quiero contactarme
        </a>
      </div>
    </div>
  </section>

  <!-- Image Section -->
  <section class="py-4 md:py-8 px-4 sm:px-6 lg:px-8">
    <div class="container mx-auto max-w-6xl">
      <div class="overflow-hidden rounded-lg shadow-xl">
        <img 
          src="/img/fondo1.png" 
          alt="Equipo de desarrollo trabajando en conjunto"
          class="w-full h-auto object-cover"
        />
      </div>
    </div>
  </section>

  <!-- Divider Section -->
  <section class="py-8 px-4 sm:px-6 lg:px-8">
    <div class="container mx-auto max-w-6xl">
      <div class="border-t border-gris"></div>
    </div>
  </section>

  <!-- Estilos de la animación -->
  <style>
    /* Contenedor con altura fija para evitar saltos */
    .typing-container {
      display: inline-block;
      min-width: 280px; /* Ancho mínimo que acomode la palabra más larga */
    }
    
    /* Ajustes responsivos para el contenedor */
    @media (max-width: 768px) {
      .typing-container {
        min-width: 180px; /* Ancho menor en móviles */
      }
    }
    
    @media (max-width: 480px) {
      .typing-container {
        min-width: 150px; /* Ancho aún menor en móviles pequeños */
      }
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0; }
    }
    
    .typing-cursor {
      display: inline-block;
      animation: blink 1s step-end infinite;
    }
    
    .typing-text {
      color: #8B5CF6;
      display: inline-block;
    }
  </style>

  <!-- Script de typing mejorado -->
  <script type="text/javascript" is:inline>
    const typingConfig = {
      words: ['Paginas Webs', 'Software a medida', 'Diseño UX/UI', 'Mantenimiento'],
      typeSpeed: 100,
      deleteSpeed: 50,
      delayBetweenWords: 1500,
      loop: true
    };

    let typewriterElement;
    let timeoutId;
    let state = {
      wordIndex: 0,
      charIndex: 0,
      isDeleting: false
    };

    // Función para calcular el ancho del contenedor basado en la palabra más larga
    function setOptimalContainerWidth() {
      const typingContainer = document.querySelector('.typing-container');
      if (!typingContainer) return;
      
      // Crear un elemento temporal para medir el ancho
      const tempSpan = document.createElement('span');
      tempSpan.style.visibility = 'hidden';
      tempSpan.style.position = 'absolute';
      tempSpan.style.whiteSpace = 'nowrap';
      tempSpan.style.fontSize = window.getComputedStyle(typewriterElement).fontSize;
      tempSpan.style.fontFamily = window.getComputedStyle(typewriterElement).fontFamily;
      tempSpan.style.fontWeight = window.getComputedStyle(typewriterElement).fontWeight;
      
      document.body.appendChild(tempSpan);
      
      // Encontrar la palabra más larga
      let maxWidth = 0;
      typingConfig.words.forEach(word => {
        tempSpan.textContent = word;
        const width = tempSpan.getBoundingClientRect().width;
        maxWidth = Math.max(maxWidth, width);
      });
      
      // Añadir un pequeño margen
      maxWidth += 10;
      
      // Ajustar el ancho del contenedor para dispositivos móviles
      if (window.innerWidth <= 768) {
        maxWidth = Math.min(maxWidth, window.innerWidth * 0.4);
      }
      
      typingContainer.style.minWidth = `${maxWidth}px`;
      document.body.removeChild(tempSpan);
    }

    function animateTyping() {
      if (!typewriterElement) return;

      const currentWord = typingConfig.words[state.wordIndex];
      state.charIndex = state.isDeleting 
        ? state.charIndex - 1 
        : state.charIndex + 1;

      typewriterElement.textContent = currentWord.substring(0, state.charIndex);

      let typingSpeed = state.isDeleting ? typingConfig.deleteSpeed : typingConfig.typeSpeed;

      if (!state.isDeleting && state.charIndex === currentWord.length) {
        typingSpeed = typingConfig.delayBetweenWords;
        state.isDeleting = true;
      } else if (state.isDeleting && state.charIndex === 0) {
        state.isDeleting = false;
        state.wordIndex = (state.wordIndex + 1) % typingConfig.words.length;
      }

      timeoutId = setTimeout(animateTyping, typingSpeed);
    }

    function initTypingEffect() {
      typewriterElement = document.getElementById('typewriter');
      if (typewriterElement) {
        setOptimalContainerWidth();
        state = { wordIndex: 0, charIndex: 0, isDeleting: false };
        animateTyping();
      }
    }

    // Iniciar la animación cuando el DOM esté listo
    document.addEventListener('DOMContentLoaded', initTypingEffect);
    
    // Recalcular el ancho cuando cambie el tamaño de la ventana
    window.addEventListener('resize', setOptimalContainerWidth);
    
    // Limpiar el timeout cuando sea necesario
    window.addEventListener('beforeunload', () => timeoutId && clearTimeout(timeoutId));
    document.addEventListener('visibilitychange', () => {
      if (document.visibilityState === 'hidden' && timeoutId) {
        clearTimeout(timeoutId);
      } else if (document.visibilityState === 'visible' && typewriterElement) {
        animateTyping();
      }
    });
  </script>
</main>